@using Store.Models.DTOs
@using Store.Models.Results
@{
    IDataResult<List<CategoryDTO>>? categoriesWithProducts = ViewBag.CategoriesWithProducts as IDataResult<List<CategoryDTO>>;
    IDataResult<List<SliderDTO>>? slider = ViewBag.Slider as IDataResult<List<SliderDTO>>;

}
@{
    ViewData["Title"] = "Anasayfa";
}
<!-- Slider Section -->
<partial name="~/Views/Home/_SliderPartial.cshtml" model="@slider" />
<!-- End Slider Section -->
@* <!-- Categories Carousel -->
<partial name="~/Views/Home/_CategoryCarouselPartial.cshtml" />
<!-- End Categories Carousel --> *@


<div class="container">
    @Html.Partial("~/Views/Home/_CategoryBannerAPartial.cshtml", categoriesWithProducts)
    @if (categoriesWithProducts != null)
    {
        foreach (var category in categoriesWithProducts.Data.Where(a => a.ParentCategoryId != 0)) //&& a.Products.Count >= 7
        {
            <div class="mb-6">
                <div class="d-md-flex justify-content-between border-bottom border-color-1 flex-lg-nowrap flex-wrap border-sm-top-0 border-sm-bottom-0">
                    <h3 class="section-title mb-2 mb-md-0 pb-2 font-size-22">@category.Name</h3>
                    <a class="d-block text-gray-16" href="../shop/shop.html">Go to Daily Deals Section <i class="ec ec-arrow-right-categproes"></i></a>
                </div>
                <div class="js-slick-carousel u-slick overflow-hidden u-slick-overflow-visble pt-3 pb-4 px-1"
                     data-pagi-classes="text-center right-0 bottom-1 left-0 u-slick__pagination u-slick__pagination--long mb-0 z-index-n1 mt-4"
                     data-slides-show="7"
                     data-slides-scroll="1"
                     data-responsive='[{
                     "breakpoint": 1500,
                     "settings": {
                     "slidesToShow": 6
                     }
                     }, {
                     "breakpoint": 1200,
                     "settings": {
                     "slidesToShow": 3
                     }
                     }, {
                     "breakpoint": 992,
                     "settings": {
                     "slidesToShow": 3
                     }
                     }, {
                     "breakpoint": 768,
                     "settings": {
                     "slidesToShow": 2
                     }
                     }, {
                     "breakpoint": 554,
                     "settings": {
                     "slidesToShow": 2
                     }
                     }]'>


                    @foreach (var product in category.Products)
                    {
                        <div class="js-slide products-group">
                            <div class="product-item">
                                <div class="product-item__outer h-100">
                                    <div class="product-item__inner px-wd-4 p-2 p-md-3">
                                        <div class="product-item__body pb-xl-2">
                                            <div class="mb-2"><a href="~/product/show/@product.Id" class="font-size-12 text-gray-5">@category.Name</a></div>
                                            <h5 class="mb-1 product-item__title"><a href="~/product/show/@product.Id" class="text-blue font-weight-bold">@product.Name</a></h5>
                                            <div class="mb-2">
                                                @if (product.ProductPhotos.Where(a => !a.IsDeleted && a.IsActive).FirstOrDefault() is not null)
                                                {
                                                    <a href="~/product/show/@product.Id" class="d-block text-center"><img class="img-fluid" src="~/uploads/products/212X200/@product.ProductPhotos.Where(a=>!a.IsDeleted && a.IsActive).FirstOrDefault().Url" alt="Image Description"></a>

                                                }
                                                else
                                                {
                                                    <a href="~/product/show/@product.Id" class="d-block text-center"><img class="img-fluid" src="~/assets/img/212X200/img1.jpg" alt="Image Description"></a>
                                                }
                                            </div>
                                            <div class="flex-center-between mb-1">
                                                <div class="prodcut-price">
                                                    <div class="text-gray-100">₺@product.Price</div>
                                                </div>
                                                <div class="d-none d-xl-block prodcut-add-cart">
                                                    <a href="../shop/single-product-fullwidth.html" class="btn-add-cart btn-primary transition-3d-hover"><i class="ec ec-add-to-cart"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="product-item__footer">
                                            <div class="border-top pt-2 flex-center-between flex-wrap">
                                                <a href="../shop/compare.html" class="text-gray-6 font-size-13"><i class="ec ec-compare mr-1 font-size-15"></i> Karşılaştır</a>
                                                <a href="../shop/wishlist.html" class="text-gray-6 font-size-13"><i class="ec ec-favorites mr-1 font-size-15"></i> Favorilere Ekle</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }

                </div>
            </div>
        }
    }
</div>